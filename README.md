# EPS Revision Momentum Strategy v4 (US Stocks)

미국 주식 대상 EPS 리비전 모멘텀 전략 시스템

## 버전 히스토리

| 버전 | 날짜 | 주요 변경 |
|------|------|----------|
| v4 | 2026-01-31 | 저평가/성장 필터, 정배열 보너스, 펀더멘털 분석 추가 |
| v3 | 2026-01-31 | 기술적 분석 (RSI, 200일선), 상세 텔레그램 포맷 |
| v2 | 2026-01-30 | Kill Switch, 거래대금 필터, 가중치 스코어링 |
| v1 | 2026-01-30 | 초기 버전 |

---

## 전략 개요

**핵심 아이디어**: 애널리스트들의 Forward EPS 컨센서스 상향 조정 + 저평가/성장 필터

### v4 스크리닝 필터 (엄격)

```
1. EPS 모멘텀 (필수)
   ├ Kill Switch: 7일 대비 -1% 이상 하락시 제외
   ├ 모멘텀 점수 >= 4.0 (가중치 3-2-1 + 정배열 보너스)
   └ 거래대금 >= $20M

2. 펀더멘털 필터 (필수 - 저평가 OR 성장 중 하나)
   ├ 저평가: PEG < 1 또는 52주 고점 대비 -10% 이상
   └ 성장: 매출 >= +10% AND 영업이익 >= +5% (YoY 또는 QoQ)

3. 기술적 분석 (정보 제공)
   ├ RSI(14): 과열/과매도 판단
   ├ 20일/200일 이동평균선
   └ 매수 타이밍 신호 (한국어)
```

### 정배열 보너스 (신규)

EPS가 꾸준히 상승하는 종목에 추가 점수:

```
정배열: Current > 7일 > 30일 > 60일
├ 완전 정배열: +3점 보너스
└ 부분 정배열: +1점 보너스
```

---

## 기술적 분석 신호

| 우선순위 | 조건 | 액션 |
|---------|------|------|
| 1 | 현재가 < 200일선 | 📉 추세이탈 (200일선↓) |
| 2 | RSI ≥ 70 | ✋ 진입금지 (과열) |
| 3 | RSI 50~65 & 20일선 근처 | 🚀 강력매수 (눌림목) |
| 4 | RSI < 40 & 현재가 > 200일선 | 🟢 저점매수 (반등) |
| 5 | 현재가 > 20일선 | 🟢 매수적기 (추세) |
| 6 | 기타 | 👀 관망 (20일선 이탈) |

---

## 텔레그램 메시지 포맷 (v4)

```
🚀 [01/31] EPS 모멘텀 일일 브리핑
━━━━━━━━━━━━━━━━━━━━━━
📅 2026-01-31 07:00 | 총 25개 종목 통과

1. MU Micron Technology ($414.9)
   ├ 📊 점수 31.8⬆ | EPS +114% | PEG 0.1 | 반도체
   ├ 💰 매출+57% 영업+182% | 📈정배열 🌱고성장
   └ 🎯 ✋ 진입금지 (과열) (RSI 72 | $15.2B)

2. AMD Advanced Micro Devices ($236.7)
   ├ 📊 점수 9.5⬆ | EPS +3% | PEG 0.6 | 반도체
   ├ 💰 매출+36% 영업+75% | 📈정배열 💎PEG 0.6 🌱고성장
   └ 🎯 🚀 강력매수 (눌림목) (RSI 55 | $8.8B)

━━━━━━━━━━━━━━━━━━━━━━
📊 시장 테마 분석
• Semiconductor (🎯Narrow): 8종목
  └ ETF 추천: SMH (1x) / SOXL (3x)

━━━━━━━━━━━━━━━━━━━━━━
✨ 품질 지표
• 📈 정배열: 18개 (72%)
• 💎 저평가: 12개
• 🌱 고성장: 8개
```

### 태그 설명

| 태그 | 의미 | 기준 |
|------|------|------|
| 📈정배열 | EPS 꾸준히 상승 | C > 7d > 30d > 60d |
| 💎저평가 | 가치 대비 저평가 | PEG<1 또는 52주高-10% |
| 🌱고성장 | 실적 고성장 | 매출≥+10% & 영업≥+5% |
| ⬆ | 정배열 표시 | 점수 옆 화살표 |

---

## 파일 구조

```
eps-momentum-us/
├── daily_runner.py          # 자동화 시스템 (스크리닝 + 텔레그램 + Git)
├── eps_momentum_system.py   # 코어 로직 (스코어링, 필터)
├── sector_analysis.py       # 섹터 분석 + ETF 추천
├── run_daily.bat            # Windows 작업 스케줄러용
├── config.json              # 설정 (텔레그램, Git 등)
├── eps_momentum_data.db     # SQLite DB (백테스트용)
├── eps_data/                # 일일 스크리닝 CSV
├── reports/                 # HTML/MD 리포트
└── logs/                    # 실행 로그
```

---

## 데이터베이스 스키마 (v4)

Track 2에서 백테스팅용으로 저장하는 데이터:

| 필드 | 타입 | 설명 |
|------|------|------|
| eps_current~eps_90d | REAL | EPS 추세 데이터 |
| score_321, score_slope | REAL | 스코어 (A/B 테스트) |
| is_aligned | INTEGER | 정배열 여부 |
| is_undervalued | INTEGER | 저평가 여부 |
| is_growth | INTEGER | 고성장 여부 |
| peg, forward_pe | REAL | 밸류에이션 |
| from_52w_high | REAL | 52주 고점 대비 (%) |
| rsi | REAL | RSI(14) |
| rev_growth_yoy | REAL | 매출 성장률 (YoY) |
| op_growth_yoy | REAL | 영업이익 성장률 (YoY) |

---

## 사용법

```bash
# 전체 자동 실행 (스크리닝 + 데이터 축적 + 텔레그램)
python daily_runner.py

# Windows 작업 스케줄러 등록
schtasks /create /tn "EPS_Momentum_Daily" /tr "C:\...\run_daily.bat" /sc daily /st 07:00
```

---

## 필터 변경 이력

### v4 변경 (2026-01-31)

**추가된 필터:**
1. **저평가/성장 엄격 필터**: 저평가 OR 성장 중 하나 충족 필수
2. **정배열 보너스**: 완전 정배열 +3점, 부분 정배열 +1점
3. **MA20 필터 제거**: 저평가 필터로 대체

**결과:**
- 기존: 74개 → 변경: 약 25~35개 (엄격)
- 노이즈 감소, 품질 향상

### Kill Switch 완화 (2026-01-31)

- 기존: 0.01%라도 하락시 제외 (너무 엄격)
- 변경: -1% 이상 하락시에만 제외 (일시적 변동 허용)

---

## 투 트랙 시스템

```
Track 1 (실시간 트레이딩)
├── 매일 스크리닝 실행
├── EPS 모멘텀 + 저평가/성장 필터
├── 정배열 보너스 적용
└── 텔레그램 알림

Track 2 (백테스트 데이터)
├── 433개 전체 종목 저장 (통과/불통과 모두)
├── 펀더멘털 지표 저장 (PEG, 성장률, RSI 등)
├── 6개월 후 Point-in-Time 백테스트 가능
└── Survivorship Bias 방지
```

---

## 의존성

```bash
pip install yfinance pandas numpy
```

## 데이터 소스

- Yahoo Finance API (`yfinance`)
- EPS Trend: `stock.eps_trend` (Forward 1 Year)
- Quarterly Financials: `stock.quarterly_financials`

---

## 주의사항

1. **야후 파이낸스 데이터 한계**: 중소형주 재무 데이터 누락 가능
   - 해결: 데이터 없으면 필터 통과 (좋은 종목 놓치지 않음)

2. **API 호출 제한**: 너무 빈번한 호출 시 제한될 수 있음
   - 해결: 일 1회 실행 권장

3. **투자 책임**: 본 시스템은 참고용이며, 투자 결정은 본인 책임

---

## 향후 과제

1. **Point-in-Time 백테스트**: 6개월 데이터 축적 후 검증
2. **Score_321 vs Score_Slope**: A/B 테스트 결과 분석
3. **포지션 사이징**: 점수 기반 비중 배분
4. **실시간 알림**: 장중 Kill Switch 발동 시 알림
